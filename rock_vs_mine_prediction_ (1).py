# -*- coding: utf-8 -*-
"""Rock_vs_Mine_Prediction .ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/14xicAkZ1mOQ7LvJdpPIHK0oJcvwDQc6Y
"""

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

sonar_data = pd.read_csv("/content/sonar data.csv" , header = None)

sonar_data.head()

sonar_data.shape

sonar_data.describe()

sonar_data[60].value_counts()

sonar_data.groupby(60).mean()

X = sonar_data.drop(columns=60 , axis=1)
Y = sonar_data[60]
print(X)
print(Y)

x_train , x_test , y_train , y_test = train_test_split(X,Y,test_size=0.1 , stratify = Y , random_state=1)

print(X.shape , x_train.shape , x_test.shape)

model = LogisticRegression()

"""ek baar eisko mode ko train kr diya"""

model.fit(x_train , y_train)

"""fir vhi jise train kra use uski khud ke accuracy dekh rhe"""

x_train_predicton = model.predict(x_train)
traning_data_accuracy = accuracy_score(x_train_predicton,y_train)

print(traning_data_accuracy)

"""abb nye data pe acuracy dekh rhe"""

x_test_predicton = model.predict(x_test)
testing_data_accuracy = accuracy_score(x_test_predicton,y_test)
print(testing_data_accuracy)

"""abb ek random data point le liya trained mai se use check krke dekh rhe"""

input_data = (0.0352,0.0116,0.0191,0.0469,0.0737,0.1185,0.1683,0.1541,0.1466,0.2912,0.2328,0.2237,0.2470,0.1560,0.3491,0.3308,0.2299,0.2203,0.2493,0.4128,0.3158,0.6191,0.5854,0.3395,0.2561,0.5599,0.8145,0.6941,0.6985,0.8660,0.5930,0.3664,0.6750,0.8697,0.7837,0.7552,0.5789,0.4713,0.1252,0.6087,0.7322,0.5977,0.3431,0.1803,0.2378,0.3424,0.2303,0.0689,0.0216,0.0469,0.0426,0.0346,0.0158,0.0154,0.0109,0.0048,0.0095,0.0015,0.0073,0.0067)
convertion_to_array = np.asarray(input_data)
input_data_reshape = convertion_to_array.reshape(1,-1)
prediction = model.predict(input_data_reshape)
if(prediction[0]=='R') :
   print('the object is rock')
else :
  print('the object is a mine')
print(prediction)

from google.colab import drive
drive.mount('/content/drive')

